todo handle sql opening and closing
